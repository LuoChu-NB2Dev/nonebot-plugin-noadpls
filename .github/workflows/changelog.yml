# 更新 Changelog 工作流
# 可以手动触发或被其他工作流调用

name: Update Changelog

on:
  workflow_dispatch: # 手动触发
  workflow_call: # 允许被其他工作流调用

jobs:
  changelog:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
          ref: main

      - name: Update changelog
        uses: rhysd/changelog-from-release/action@v3
        with:
          file: CHANGELOG.md
          github_token: ${{ secrets.GITHUB_TOKEN }}
          args: -l 2 -d=true -p=true -i="^v0\.1\.[1-8]"
          header: |
            # Changelog

            本文档记录了项目的所有重要变更。

            格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
            并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。
